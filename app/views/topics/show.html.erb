<div class="hero-unit">
  <h1><%= @topic.title %></h1>
  <p><%= @topic.description %></p>
</div>

<div class="row">
  <div class="span12">
    <div id="topic-support-graph"></div>
  </div>
</div>

<hr class="soften">

<div class="row">
  <div class="span6">
    <h3>Voteringer om temaet</h3>
    <table class="table-condensed">
      <thead>
        <tr>
          <th><%= Issue.human_attribute_name :summary %></th>
          <th><%= Vote.human_attribute_name :subject %></th>
          <th><%= Vote.human_attribute_name :enacted %></th>
        </tr>
      </thead>
      <tbody>
      <% @topic.votes.each do |vote| %>
        <tr>
          <td><%= link_to vote.issues.first.summary, vote.issues.first %></td>
          <td><%= link_to vote.subject, vote %></td>
          <td><%= vote.enacted_text %></td>
        </tr>
      <% end %>
      </tbody>
    </table>
  </div>

  <div class="span6">
    <h3>Partienes l√∏fter om temaet</h3>
    <table class="table-condensed">
      <thead>
        <tr>
          <th><%= Promise.human_attribute_name :party %></th>
          <th><%= Promise.human_attribute_name :body %></th>
        </tr>
      </thead>
      <tbody>
        <% @topic.promises.each do |promise| %>
        <tr>
          <td><%= link_to promise.party.name, promise.party %></td>
          <td><%= promise.body %></td>
        </tr>
      <% end %>
      </tbody>
    </table>
  </div>
</div>

<% if user_signed_in? %>
  <%= link_to 'Edit', edit_topic_path(@topic) %> |
  <%= link_to 'Back', topics_path %>
<% end %>

<% content_for :document_ready do %>
<script type="text/javascript" charset="utf-8">
  $(document).ready(function() {
    new TopicSupportGraph("topic-support-graph", JSON.parse(<%= @topic.stats.to_json.html_safe %>)).render();
  });
</script>
<% end %>