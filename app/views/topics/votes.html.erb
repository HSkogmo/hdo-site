<%= link_to 'Tilbake', topic %>
<div class="row-fluid">
  <div class="span12">
    <h3><%= Vote.model_name.human(count: 2).capitalize %> om <%= topic.title.downcase %></h3>
    <table class="table">
      <thead>
        <th>Beskrivelse</th>
        <th>Hva har partiene stemt?</th>
        <th>Vedtatt</th>
      </thead>
      <tbody>
        <% topic.vote_connections.each do |connection| %>
          <tr>
            <td>
              <%= link_to connection.vote do %>
                <%= connection.comment %>
              <% end %>
            </td>
            <td>
              <% if connection.vote.personal? %>
                <% stats = connection.vote.stats %>
                <% stats.party_votes.each do |party, vote_counts| %>
                  <p>
                    <%= image_tag party.image.thumb('35x35').strip.url, alt: "#{party.name}s logo" %>
                    <%= "#{party.name.capitalize} har stemt for." if stats.party_for?(party) %>
                    <%= "#{party.name.capitalize} har stemt mot." if stats.party_against?(party) %>
                    <%= "#{party.name.capitalize} har ikke tatt standpunkt." if !stats.party_participated?(party) %>
                    <small><%= "(#{vote_counts[:for]} for, #{vote_counts[:against]} mot, #{vote_counts[:absent]} ikke tilstede.)" %></small>
                  </p>
                <% end %>
              <% else %>
                <%= I18n.t('app.votes.non_party') %>
              <% end %>
            </td>
            <td>
              <span class="label label-<%= connection.vote.enacted ? 'success' : 'important' %>">
                <%= connection.vote.enacted_text %>
              </span>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
</div>